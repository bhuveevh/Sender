<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VacancyHai.online - फाइल सेंडर</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap');

        body {
            font-family: 'Roboto', Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-color: #f0f0f0;
            margin: 0;
            overflow-x: hidden; /* क्षैतिज स्क्रॉल से बचने के लिए */
        }

        .container {
            background-color: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
            text-align: center;
            max-width: 550px;
            width: 90%;
            border: 2px solid #ccc;
            box-sizing: border-box; /* पैडिंग और बॉर्डर को चौड़ाई में शामिल करें */
        }

        .header {
            font-size: 1.8em;
            font-weight: 700;
            color: #333;
            margin-bottom: 25px;
            letter-spacing: 1px;
            color: #0000FF;
        }

        .input-row {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap; /* छोटे स्क्रीन के लिए */
            gap: 10px; /* एलिमेंट्स के बीच गैप */
        }

        .input-group {
            display: flex;
            align-items: center;
            flex-grow: 1; /* उपलब्ध स्थान भरने के लिए */
            position: relative;
        }

        .input-group input[type="text"] {
            flex-grow: 1;
            padding: 12px 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1em;
            outline: none;
            transition: border-color 0.3s ease;
            box-sizing: border-box; /* पैडिंग और बॉर्डर को चौड़ाई में शामिल करें */
        }

        .input-group input[type="text"]:focus {
            border-color: #0000FF;
        }

        .required-star {
            color: red;
            font-size: 1.5em;
            position: absolute;
            right: 10px; /* इनपुट के भीतर पोजीशन */
            top: 50%;
            transform: translateY(-50%);
            pointer-events: none;
        }
        /* Trust Title के लिए स्टार को थोड़ा अलग पोजीशन करें */
        .trust-title-group .required-star {
            right: 15px; /* या अपने अनुसार एडजस्ट करें */
        }

        /* File Upload Button */
        .file-upload-wrapper {
            position: relative;
            display: flex; /* Flexbox का उपयोग करें */
            align-items: center; /* वर्टिकल सेंटर */
            justify-content: center; /* हॉरिजॉन्टल सेंटर */
            width: 50px; /* निश्चित चौड़ाई */
            height: 50px; /* निश्चित ऊंचाई */
            flex-shrink: 0; /* सिकुड़ने से रोकें */
        }
        .file-upload-button {
            background-color: #0000FF;
            color: white;
            padding: 12px 15px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.2em;
            transition: background-color 0.3s ease;
            width: 100%; /* रैपर के भीतर पूरी चौड़ाई */
            height: 100%; /* रैपर के भीतर पूरी ऊंचाई */
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .file-upload-button:hover {
            background-color: #0056b3;
        }
        .file-upload-button::before {
            content: '↑';
            font-size: 1.5em;
        }
        #fileInput {
            position: absolute;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            cursor: pointer;
        }

        /* vH ID चेक बटन */
        .vh-id-check-button {
            background-color: #0000FF;
            color: white;
            padding: 12px 15px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            transition: background-color 0.3s ease;
            flex-shrink: 0; /* सिकुड़ने से रोकें */
        }
        .vh-id-check-button:hover {
            background-color: #0056b3;
        }
        .vh-id-check-button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
            opacity: 0.7;
        }

        .status-message {
            margin-top: 15px;
            font-weight: bold;
            min-height: 20px;
            font-size: 0.95em;
        }
        .success { color: green; }
        .error { color: red; }
        .info { color: #0000FF; }
        .warning { color: orange; }

        .vh-id-status {
            font-size: 0.85em;
            margin-top: 5px;
            text-align: right;
            padding-right: 5px;
            min-height: 18px;
        }
        .vh-id-status.available { color: green; }
        .vh-id-status.unavailable { color: red; }
        .vh-id-status.info-check { color: #0000FF; } /* चेक होने पर नीला */

        .send-button {
            background-color: #28a745;
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.3em;
            font-weight: bold;
            transition: background-color 0.3s ease, opacity 0.3s ease;
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 20px; /* थोड़ा स्पेस दें */
        }
        .send-button:hover:not(:disabled) {
            background-color: #218838;
        }
        .send-button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
            opacity: 0.7;
        }
        .send-button::after {
            content: '▶';
            margin-left: 10px;
            font-size: 1.1em;
        }

        .footer {
            margin-top: 30px;
            font-size: 0.8em;
            color: #777;
        }

        .logo {
            width: 150px;
            height: auto;
            margin-top: -15px;
            margin-bottom: 10px;
        }
        .file-info {
            font-size: 0.85em;
            color: #555;
            margin-bottom: 15px;
            min-height: 20px;
            text-align: left; /* फ़ाइल जानकारी को बाईं ओर अलाइन करें */
        }
        .file-info span {
            font-weight: bold;
        }

        /* Responsive adjustments */
        @media (max-width: 600px) {
            .container {
                padding: 20px;
                width: 95%; /* छोटे स्क्रीन पर थोड़ी अधिक चौड़ाई */
            }
            .header {
                font-size: 1.5em;
            }
            .input-row {
                flex-direction: column; /* इनपुट को स्टैक करें */
                gap: 15px; /* स्टैक्ड होने पर अधिक गैप */
            }
            .input-group {
                width: 100%; /* पूरी चौड़ाई लें */
            }
            .file-upload-wrapper {
                width: 100%; /* छोटे स्क्रीन पर भी पूरी चौड़ाई */
                height: 50px;
                justify-content: flex-start; /* बाईं ओर अलाइन करें */
            }
            .file-upload-button {
                width: 100px; /* अपलोड बटन के लिए थोड़ी चौड़ाई */
            }
            .vh-id-check-button {
                width: 100%;
            }
            .input-group .required-star {
                right: 15px; /* छोटे स्क्रीन पर भी सही पोजीशन पर हो */
            }
            .trust-title-group .required-star {
                right: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <img src="vacancyhai.online_logo_@_.webp" alt="VacancyHai.online Logo" class="logo"> <br>
            VACANCYHAI.ONLINE - SENDER
        </div>

        <form id="uploadForm">
            <div class="input-row">
                <div class="file-upload-wrapper">
                    <button type="button" class="file-upload-button" title="फाइल अपलोड करें"></button>
                    <input type="file" id="fileInput" name="document">
                </div>
                <div class="input-group trust-title-group">
                    <input type="text" id="trustTitleInput" class="trust-title-input" placeholder="Trust Title..." maxlength="20" minlength="3" required>
                    <span class="required-star">*</span>
                </div>
            </div>

            <div class="input-row" style="align-items: flex-end;"> <div class="input-group">
                    <input type="text" id="vhIdInput" class="vh-id-input" placeholder="vH id----" maxlength="5" pattern="[0-9]{5}" required>
                    <span class="required-star">*</span>
                </div>
                <button type="button" id="checkVhIdButton" class="vh-id-check-button" disabled>Check ID</button>
            </div>
            <div class="vh-id-status" id="vhIdStatus"></div>
            
            <div class="file-info" id="fileInfo"></div>

            <div class="status-message" id="generalStatusMessage"></div>

            <button type="submit" id="sendButton" class="send-button" disabled>Send Files</button>
        </form>

        <div class="footer">
            Developed by VACANCYHAI.ONLINE | Inspired by USERS
        </div>
    </div>

    <script>
        // !! चेतावनी: यह कोड आपका Telegram Bot Token सार्वजनिक रूप से उजागर करता है !!
        // !! यह एक गंभीर सुरक्षा जोखिम है और इसे उत्पादन में उपयोग नहीं किया जाना चाहिए !!
        // !! सुरक्षा कारणों से एक सुरक्षित बैकएंड (सर्वर/सर्वरलेस फंक्शन) का उपयोग करने की अत्यधिक सलाह दी जाती है !!

        const BOT_TOKEN = '8024108932:AAHMIqs0MFH9mN8NF5by-0uepbRHDyjqfdU'; // आपका दिया गया बॉट टोकन
        const CHANNEL_ID = '-1002606747957'; // आपका दिया गया चैनल ID

        // Google Sheet URL (CSV Export)
        const GOOGLE_SHEET_CSV_URL = 'https://docs.google.com/spreadsheets/d/1u53nFs5LHJAroQ3KQYK_eato29qT89f-ypfdjuApycI/export?format=csv&gid=0';

        // UI एलिमेंट्स
        const uploadForm = document.getElementById('uploadForm');
        const fileInput = document.getElementById('fileInput');
        const trustTitleInput = document.getElementById('trustTitleInput');
        const vhIdInput = document.getElementById('vhIdInput');
        const checkVhIdButton = document.getElementById('checkVhIdButton'); // नया बटन
        const vhIdStatus = document.getElementById('vhIdStatus');
        const fileInfo = document.getElementById('fileInfo');
        const generalStatusMessage = document.getElementById('generalStatusMessage');
        const sendButton = document.getElementById('sendButton');

        // फ़ाइल साइज़ और एक्सटेंशन प्रतिबंध
        const MAX_FILE_SIZE_BYTES = 5 * 1024 * 1024; // 5 MB
        const SUPPORTED_EXTENSIONS = ['jpg', 'jpeg', 'webp', 'png', 'pdf', 'docx'];

        let isVhIdAvailable = false;
        let selectedFile = null;

        // --- फ़ाइल इनपुट परिवर्तन हैंडलर ---
        fileInput.addEventListener('change', () => {
            selectedFile = fileInput.files[0];
            if (selectedFile) {
                fileInfo.textContent = `फाइल: ${selectedFile.name} (${(selectedFile.size / (1024 * 1024)).toFixed(2)} MB)`;
            } else {
                fileInfo.textContent = '';
            }
            validateForm();
        });

        // --- Trust Title इनपुट वैलिडेशन ---
        trustTitleInput.addEventListener('input', validateForm);

        // --- vH ID इनपुट और चेक बटन लॉजिक ---
        vhIdInput.addEventListener('input', () => {
            // vH ID इनपुट पर 'Check ID' बटन को इनेबल/डिसेबल करें
            checkVhIdButton.disabled = !(vhIdInput.value.length === 5 && /^[0-9]{5}$/.test(vhIdInput.value));
            vhIdStatus.textContent = ''; // जब टाइप करें तो स्टेटस रीसेट करें
            vhIdStatus.className = 'vh-id-status';
            isVhIdAvailable = false; // टाइप करते ही अनुपलब्ध मानें
            validateForm(); // बटन डिसेबल होने पर फॉर्म वैलिडेशन को अपडेट करें
        });

        checkVhIdButton.addEventListener('click', () => {
            const vhId = vhIdInput.value;
            if (vhId.length === 5 && /^[0-9]{5}$/.test(vhId)) {
                vhIdStatus.textContent = 'जांच हो रही है...';
                vhIdStatus.className = 'vh-id-status info-check';
                checkVhIdInSheet(vhId);
            } else {
                vhIdStatus.textContent = 'कृपया 5 अंकों की न्यूमेरिक ID डालें।';
                vhIdStatus.className = 'vh-id-status warning';
                isVhIdAvailable = false;
                validateForm();
            }
        });

        async function checkVhIdInSheet(idToCheck) {
            checkVhIdButton.disabled = true; // चेक करते समय बटन डिसेबल करें
            try {
                // CORS समस्या यहाँ आ सकती है। यदि यह विफल होता है, तो आपको एक बैकएंड प्रॉक्सी की आवश्यकता होगी।
                const response = await fetch(GOOGLE_SHEET_CSV_URL);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const csvText = await response.text();
                
                const rows = csvText.split('\n');
                let found = false;
                for (let i = 0; i < rows.length; i++) {
                    const columns = rows[i].split(',');
                    if (columns[0] && columns[0].trim() === idToCheck) {
                        found = true;
                        break;
                    }
                }

                if (found) {
                    vhIdStatus.textContent = 'Available';
                    vhIdStatus.className = 'vh-id-status available';
                    isVhIdAvailable = true;
                } else {
                    vhIdStatus.textContent = 'Unavailable';
                    vhIdStatus.className = 'vh-id-status unavailable';
                    isVhIdAvailable = false;
                }
            } catch (error) {
                console.error('Google Sheet से vH ID की जांच करते समय त्रुटि:', error);
                vhIdStatus.textContent = 'ID जांचने में त्रुटि। (CORS?)';
                vhIdStatus.className = 'vh-id-status error';
                isVhIdAvailable = false;
            } finally {
                checkVhIdButton.disabled = !(vhIdInput.value.length === 5 && /^[0-9]{5}$/.test(vhIdInput.value)); // जांच खत्म होने पर फिर से इनेबल करें
                validateForm();
            }
        }

        // --- फॉर्म वैलिडेशन और बटन सक्रियण ---
        function validateForm() {
            const isTrustTitleValid = trustTitleInput.value.length >= 3 && trustTitleInput.value.length <= 20;
            const isFileSelected = selectedFile !== null;
            const isFileValidSize = isFileSelected && selectedFile.size <= MAX_FILE_SIZE_BYTES;
            const isFileValidExtension = isFileSelected && SUPPORTED_EXTENSIONS.includes(selectedFile.name.split('.').pop().toLowerCase());
            
            // Send button enablement:
            // 1. Trust Title valid
            // 2. vH ID is available (checked via button)
            // 3. File is selected and valid (size/extension)
            sendButton.disabled = !(isTrustTitleValid && isVhIdAvailable && isFileSelected && isFileValidSize && isFileValidExtension);

            // सामान्य स्थिति संदेश अपडेट करें
            if (!isFileSelected) {
                generalStatusMessage.textContent = 'कृपया एक फाइल चुनें।';
                generalStatusMessage.className = 'status-message info';
            } else if (!isFileValidSize) {
                generalStatusMessage.textContent = `फाइल का आकार ${Math.round(selectedFile.size / (1024 * 1024))} MB है, जो अधिकतम 5 MB से अधिक है।`;
                generalStatusMessage.className = 'status-message error';
            } else if (!isFileValidExtension) {
                generalStatusMessage.textContent = `असमर्थित फाइल फॉर्मेट: .${selectedFile.name.split('.').pop().toLowerCase()}।`;
                generalStatusMessage.className = 'status-message error';
            } else if (!isTrustTitleValid) {
                 generalStatusMessage.textContent = 'Trust Title 3-20 अक्षरों का होना चाहिए।';
                 generalStatusMessage.className = 'status-message warning';
            } else if (!isVhIdAvailable) {
                generalStatusMessage.textContent = 'कृपया vH ID की जांच करें और सुनिश्चित करें कि यह उपलब्ध है।';
                generalStatusMessage.className = 'status-message warning';
            } else {
                generalStatusMessage.textContent = 'फाइल भेजने के लिए तैयार है।';
                generalStatusMessage.className = 'status-message success';
            }
        }

        // --- फॉर्म सबमिट हैंडलर (टेलीग्राम पर भेजें) ---
        uploadForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            validateForm();
            if (sendButton.disabled) {
                return;
            }

            generalStatusMessage.textContent = 'फाइल भेजी जा रही है... कृपया प्रतीक्षा करें।';
            generalStatusMessage.className = 'status-message info';
            sendButton.disabled = true; // भेजने के दौरान बटन डिसेबल करें

            const file = selectedFile;
            const trustTitle = trustTitleInput.value;
            const vhId = vhIdInput.value;

            const formData = new FormData();
            formData.append('chat_id', CHANNEL_ID);
            formData.append('document', file);
            // कैप्शन में Trust Title और vH ID जोड़ें
            formData.append('caption', `${trustTitle} (vH id-${vhId})`); 

            try {
                const telegramApiUrl = `https://api.telegram.org/bot${BOT_TOKEN}/sendDocument`;

                const response = await fetch(telegramApiUrl, {
                    method: 'POST',
                    body: formData,
                });

                const data = await response.json();

                if (response.ok && data.ok) {
                    generalStatusMessage.textContent = 'फाइल सफलतापूर्वक टेलीग्राम चैनल पर भेजी गई!';
                    generalStatusMessage.className = 'status-message success';
                    // फॉर्म और स्थिति रीसेट करें
                    uploadForm.reset();
                    selectedFile = null;
                    fileInfo.textContent = '';
                    vhIdStatus.textContent = '';
                    vhIdStatus.className = 'vh-id-status';
                    isVhIdAvailable = false;
                    checkVhIdButton.disabled = true; // चेक बटन को फिर से डिसेबल करें
                } else {
                    let errorMessage = data.description || 'फाइल भेजने में त्रुटि हुई।';
                    if (response.status === 400 && errorMessage.includes('file too big')) {
                        errorMessage = 'फाइल का आकार Telegram की सीमा से अधिक है (अधिकतम 2GB)।';
                    }
                    generalStatusMessage.textContent = `त्रुटि: ${errorMessage}`;
                    generalStatusMessage.className = 'status-message error';
                    console.error('Telegram API Error:', data);
                }
            } catch (error) {
                generalStatusMessage.textContent = 'नेटवर्क त्रुटि या फाइल भेजने में असमर्थ।';
                generalStatusMessage.className = 'status-message error';
                console.error('Fetch error:', error);
            } finally {
                sendButton.disabled = false;
                validateForm();
            }
        });

        // पेज लोड होने पर प्रारंभिक वैलिडेशन
        validateForm();
    </script>
</body>
</html>
